<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="BN ATI Report" />
    <title>BN ATI Report</title>

    <!-- GC Design System -->
    <link rel="stylesheet" href="https://cdn.design-system.alpha.canada.ca/@cdssnc/gcds-utility@1.9.2/dist/gcds-utility.min.css" />
    <link rel="stylesheet" href="https://cdn.design-system.alpha.canada.ca/@cdssnc/gcds-components@0.40.0/dist/gcds/gcds.css" />
    <script type="module" src="https://cdn.design-system.alpha.canada.ca/@cdssnc/gcds-components@0.40.0/dist/gcds/gcds.esm.js"></script>

    <style>
      gcds-container[main-container] section { margin-left: auto; margin-right: auto; }
      .table-wrap { margin-block: 1.5rem; overflow-x: auto; }
      table { width: 100%; }
      table.dataTable tr.shown td { background: #f9fbff; }
      .dt-details { padding: .75rem 1rem; line-height: 1.35; }
      .dt-details h4 { margin: .2rem 0 .4rem; font-size: 1rem; }
      .dt-details p { margin: .25rem 0; }

      /* Section 2: chart sizing and font bump */
      .chart-wrap { width: 71.25rem; margin: 0 auto; font-size: 1.1rem; }
      #weakChart { width: 100%; height: 520px; }
    </style>
  </head>

  <body>
    <gcds-header lang-href="#" skip-to-href="#main-content">
      <gcds-search slot="search"></gcds-search>
      <gcds-breadcrumbs slot="breadcrumb">
        <gcds-breadcrumbs-item href="#">Link</gcds-breadcrumbs-item>
        <gcds-breadcrumbs-item href="#">Link</gcds-breadcrumbs-item>
      </gcds-breadcrumbs>
    </gcds-header>

    <gcds-container id="main-content" main-container size="xl" centered tag="main">
      <section>
        <gcds-heading tag="h1">BN Ã— ATI Report</gcds-heading>
        <gcds-text>
          This report cross-references BN tracking numbers in ATI summaries, and aggregates informal request counts.
          Click a row to view full details.
        </gcds-text>
      </section>

      <!-- Section 1: Stats + main paged table (SQLite-backed) -->
      <section id="section-1">
        <gcds-heading tag="h2">Section 1</gcds-heading>
        <gcds-text id="bn-ati-stats"></gcds-text>

        <div class="table-wrap">
          <gcds-heading tag="h3">BN ATI report</gcds-heading>
          <table id="report" class="display nowrap"></table>
        </div>
      </section>

      <!-- Section 2: Stacked bar chart + details table -->
      <section id="section-2" style="text-align:center;">
        <gcds-heading tag="h2">Section 2</gcds-heading>
        <gcds-text>
          Weak BN ID distribution by owner_org (stacked). Expand to view raw counts.
        </gcds-text>

        <div class="chart-wrap">
          <canvas id="weakChart" aria-label="Weak BN ID counts per owner_org"></canvas>
        </div>

        <gcds-details details-title="Chart Data" open>
          <div class="table-wrap">
            <table id="weakTable" class="display compact" style="min-width: 720px;">
              <thead>
                <tr>
                  <th>owner_org</th>
                  <th>c</th>
                  <th>1</th>
                  <th>0</th>
                  <th>NA</th>
                  <th>na</th>
                  <th>-</th>
                  <th>REDACTED</th>
                  <th>[REDACTED]</th>
                  <th>TBD-PM-00</th>
                  <th>Total</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </gcds-details>
      </section>

      <section id="section-3">
        <gcds-heading tag="h2">Section 3</gcds-heading>
        <gcds-text>Additional content.</gcds-text>
      </section>

      <gcds-date-modified>{{ build_date }}</gcds-date-modified>
    </gcds-container>

    <gcds-footer display="full" contextual-heading="Canadian Digital Service"
      contextual-links='{ "Why GC Notify": "#","Features": "#", "Activity on GC Notify": "#"}'>
    </gcds-footer>

    <!--REPORT_SCRIPT-->
  </body>
</html>
